---
import engine from "../assets/optimemotor.webp";
import salecar from "../assets/salecar2 .jpg";
import engine2 from "../assets/retouchmotorjunk.jpg";
import engine3 from "../assets/retouchmotorjunk2.jpg";
import transmition from "../assets/transmition.webp";
import transmition2 from "../assets/transmition2.webp";
---

<!-- -
    <section class="services">
   <h2 class="services__title"><span>Services</span></h2>
  </section>
  
-->
<section class="services" id="services">
  <h2 class="services__title"><span>Services</span></h2>
  <div class="divisionservices">
    <a href="#getoffer" class="containersell">
      <h3 class="title_services">WE BUY YOUR CAR</h3>
      <img src={salecar} alt="image of a car" />
    </a>
    <div class="wrap">
      <h3 class="title_services">
        SALE OF CAR ENGINES, TRANSMISSION AND MORE ...
      </h3>
      <div class="window">
        <div id="carousel">
          <img src={engine3} class="slide" id="b3" />
          <img src={engine} class="slide" id="b1" />
          <img src={engine2} class="slide" id="b2" />
          <img src={transmition} class="slide" id="b4" />
          <img src={transmition2} class="slide" id="b5" />
        </div>
      </div>
      <span id="prev">PREV</span>
      <span id="next">NEXT</span>
    </div>
  </div>
</section>
<script>
  interface SlideElement extends HTMLElement {
    id: string;
  }

  // Definir constantes y variables
  const carousel: HTMLElement = document.getElementById("carousel")!;
  const threshold: number = 150;
  const slideWidth: number = 500;
  let dragStart: number;
  let dragEnd: number;

  // Funciones auxiliares
  function dragPos(): number {
    return dragEnd - dragStart;
  }

  function shiftSlide(direction: number): void {
    if (carousel.classList.contains("transition")) return;
    dragEnd = dragStart;
    document.removeEventListener("mouseup", handleMouseUp);
    carousel.removeEventListener("mousemove", handleMouseMove);
    carousel.classList.add("transition");
    carousel.style.transform = `translateX(${direction * slideWidth}px)`;
    setTimeout(() => {
      if (direction === 1) {
        const firstSlide: SlideElement = document.querySelector(
          ".slide:first-child"
        ) as SlideElement;
        carousel.insertBefore(
          carousel.lastElementChild as HTMLElement,
          firstSlide
        );
      } else if (direction === -1) {
        const lastSlide: SlideElement = document.querySelector(
          ".slide:last-child"
        ) as SlideElement;
        carousel.insertBefore(
          carousel.firstElementChild as HTMLElement,
          lastSlide.nextSibling
        );
      }
      carousel.classList.remove("transition");
      carousel.style.transform = "translateX(0px)";
    }, 700);
  }

  // Funciones de eventos
  function handleMouseMove(event: MouseEvent): void {
    dragEnd = event.pageX;
    carousel.style.transform = `translateX(${dragPos()}px)`;
  }

  function handleMouseUp(): void {
    if (dragPos() > threshold) {
      return shiftSlide(1);
    } else if (dragPos() < -threshold) {
      return shiftSlide(-1);
    }
    shiftSlide(0);
  }

  // Asignar eventos
  document
    .getElementById("next")!
    .addEventListener("click", () => shiftSlide(-1));
  document
    .getElementById("prev")!
    .addEventListener("click", () => shiftSlide(1));

  carousel.addEventListener("mousedown", (event: MouseEvent) => {
    if (carousel.classList.contains("transition")) return;
    dragStart = event.pageX;
    carousel.addEventListener("mousemove", handleMouseMove);
    document.addEventListener("mouseup", handleMouseUp);
  });

  function translateX($: any, arg1: { dragPos(): any }, px: any): string {
    throw new Error("Function not implemented.");
  }
</script>
<style>
  .services {
    height: auto;

    background-color: var(--darkletter);
    padding: 4.5rem 8em;
  }

  .services__title {
    display: flex;
    justify-content: center;
    font-family: var(--fontBrand);
    font-size: 2rem;
    font-weight: 500;
    width: 100%;
    border-top: solid var(--white) 1px;
    color: var(--white);
  }

  .services__title span {
    background: var(--darkletter);
    padding: 0 1.5rem;
    margin-top: -0.5em;
  }
  .divisionservices {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    margin-top: 4rem;
    gap: 2rem;
  }
  .containersell {
    position: relative;
    overflow: hidden;
    flex: 1;
    height: 300px;
    min-width: 200px;
    max-width: 600px;
  }
  .containersell img {
    width: 100%; /* Ancho máximo de la imagen */
    height: 300px;
    object-fit: cover; /* Altura automática */
    display: block;
  }
  .title_services {
    font-family: var(--fontBrand);

    padding: 0.5rem;
    border-radius: 0.2rem;
    font-size: 24px;
    z-index: 100;

    color: var(--white);
    background: #001b24d0;
    padding: 0.6rem 2rem;
    position: absolute;
    margin-left: 1rem;
  }
  .wrap {
    position: relative;
    width: 600px; /* O cualquier otro valor que se desee en lugar de $carousel-width */
    height: 300px;
    margin: 0 auto;
    box-shadow: 7px 7px 5px 0px rgba(0, 0, 0, 0.25);
  }

  .window {
    overflow: hidden;
    position: relative;
    background: #222;
  }

  #carousel {
    width: 10000px;
    position: relative;
    top: 0;
    left: -450px;
  }

  .slide {
    height: 300px;
    width: 500px;
    object-fit: cover;
    cursor: pointer;
    float: left;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .slide#b1 {
    background: var(--darkletter);
  }

  .slide#b2 {
    background: var(--darkletter);
  }

  .slide#b3 {
    background: var(--darkletter);
  }

  .slide#b4 {
    background: var(--darkletter);
  }

  .slide #b5 {
    background: var(--darkletter);
  }

  #prev,
  #next {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 3rem;
    width: 3rem;
    font-family: var(--fontBrand);
    cursor: pointer;
    position: absolute;
    bottom: 40%;
    border-radius: 100%;
    background: var(--terciaryColor);
    margin: 0 1rem;
    font-size: 14pt;
    transition: 400ms;
  }

  #prev {
    left: 0;
  }
  #prev:hover {
    background: #001b2479;
  }

  #next {
    right: 0;
  }
  #next:hover {
    background: #001b2479;
  }

  .transition {
    transition: 0.7s;
  }

  @media (max-width: 840px) {
    .services {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 4rem 0;
    }
    .divisionservices {
     
      width: 100%;
      padding: 0;
      margin: 0 auto;
      gap: 7rem;
      align-items: center;
    }

    .containersell {
      width: 100%;
      align-items: center;
    }
    .containersell img {
      margin: 0 auto;
    }
    .wrap {
      max-width: 500px;
      min-width: 300px; /* O cualquier otro valor que se desee en lugar de $carousel-width */
      height: 400px;
      margin-top: -4rem;
      box-shadow: none;
    }

    #prev,
    #next {
      bottom: 55%;
    
    }
  }
  .title_services {
    top: -1rem;
    font-family: var(--fontBrand);
    padding: 0.5rem;
    border-radius: 0.2rem;
    font-size: 24px;
    z-index: 100;
    color: var(--white);
    background: #001b24d0;
    position: absolute;
    margin-left: 0;
  }
  @media screen and (min-width: 1400px) and (max-width: 2559px) {
    .divisionservices .containersell {
      margin-left: 10rem;
    }
  }
</style>
